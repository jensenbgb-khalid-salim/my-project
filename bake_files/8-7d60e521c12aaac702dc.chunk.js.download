webpackJsonp([8],{458:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a,c,u=t(18),s=t.n(u),i=t(19),o=t.n(i),l=t(1),f=t(355),p=(t(89),t(36)),h=l.a.makeI18nUrl("/navbar/search_bar_dropdown/"),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return l.a.makeI18nUrl("/search-suggestions/collections/?"+p.stringify({search_history:e},{arrayFormat:"brackets"}))},v=t(282),m=null,g=(n=o()(s.a.mark(function e(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=2;break}return e.abrupt("return",m);case 2:return e.prev=2,e.t0=JSON,e.next=6,l.a.get(l.a.makeI18nUrl("/search-suggestions/trending/"));case 6:return e.t1=e.sent,r=e.t0.parse.call(e.t0,e.t1),e.abrupt("return",m=r);case 11:e.prev=11,e.t2=e.catch(2);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}},e,this,[[2,11]])})),function(){return n.apply(this,arguments)}),y=null,b=(a=o()(s.a.mark(function e(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=2;break}return e.abrupt("return",y);case 2:return e.prev=2,e.t0=JSON,e.next=6,l.a.get(d(v.b()));case 6:return e.t1=e.sent,r=e.t0.parse.call(e.t0,e.t1),e.abrupt("return",y=r);case 11:e.prev=11,e.t2=e.catch(2);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}},e,this,[[2,11]])})),function(){return a.apply(this,arguments)}),x=(c=o()(s.a.mark(function e(r){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.t1=JSON,e.next=5,l.a.get((void 0,n="/api/v3/search/suggestions/random-place-holder/".replace("random-place-holder",r),l.a.makeI18nUrl(n)));case 5:if(e.t2=e.sent,e.t0=e.t1.parse.call(e.t1,e.t2),e.t0){e.next=9;break}e.t0=[];case 9:if(t=e.t0,Array.isArray(t)){e.next=14;break}e.next=13;break;case 13:t=[];case 14:e.next=18;break;case 16:e.prev=16,e.t3=e.catch(1);case 18:return e.abrupt("return",t.slice(0,6).map(function(e){return{text:e}}));case 19:case"end":return e.stop()}var n},e,this,[[1,16]])})),function(e){return c.apply(this,arguments)}),k={},q=function(){var e=o()(s.a.mark(function e(r){var t,n=r.query,a=r.requestId;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=k[n],e.t0){e.next=5;break}return e.next=4,x(n);case 4:e.t0=k[n]=e.sent;case 5:return t=e.t0,e.abrupt("return",{requestId:a,suggestions:t});case 7:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),w="ul.js-search-bar-suggestions",S=".js-search-bar-dropdown-aria-help",j=t(154);function T(e){var r=e.form,t=e.fullText;return(document.querySelector('[data-video-search="true"]')?r.dataset.searchUrlsVideo:r.dataset.searchUrlsPhoto).replace(r.dataset.searchUrlsQueryPlaceholder,t)}var E=function(e){return e.length<=0?"":"<strong>"+e+"</strong>"};function L(e){var r=e.fullText,t=e.query;if(!r)return"";if(r.length<=0)return"";var n=r.indexOf(t||""),a=n+t.length;if(n<0)return r;var c=r.slice(0,n),u=r.slice(a,r.length);return""+c+E(r.slice(n,a))+u}var C="js-search-bar-suggestions-item",_="js-search-bar-suggestions-item-active",I=t(33);function M(e,r){I.a.event("track-click","search-autocomplete",e,r)}var O=function(e){return 1===e?Object(j.a)("search_dropdown_aria_helper_singular"):Object(j.a)("search_dropdown_aria_helper_plural").replace("%{count}",e)},H=function(e){var r,t=e.fullText,n=e.query,a=e.form,c=(r=t,Object(j.a)("search_for_stock_media").replace("%{search_term}",r));return'\n    <li>\n      <a\n        href="'+T({form:a,fullText:t})+'"\n        class="'+C+'"\n        role="option"\n        title="'+c+'"\n      >\n        '+L({fullText:t,query:n})+"\n      </a>\n    </li>\n  "};function N(e){var r,t=this,n=function(e){var r=e.querySelector(w),t=e.querySelector(S);return r.addEventListener("click",function(e){var r=e.target;"A"===r.tagName&&M("suggestion",r.innerText.trim())}),{replaceSuggestions:function(n){var a=n.suggestions,c=n.query;t.innerText=O(a.length),r.innerHTML=a.map(function(r){var t=r.text;return H({form:e,query:c,fullText:t})}).join("\n")},updateQueryMatchHighlighting:function(e){r.querySelectorAll("."+C).forEach(function(r){r.innerHTML=L({fullText:r.innerText.trim(),query:e})})}}}(e),a=n.replaceSuggestions,c=n.updateQueryMatchHighlighting,u=0;return{queryForNewSuggestions:l.a.throttle((r=o()(s.a.mark(function e(r){var n,c,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u++,e.next=3,q({query:r,requestId:u});case 3:if(n=e.sent,c=n.requestId,i=n.suggestions,!(c<u)){e.next=8;break}return e.abrupt("return");case 8:a({suggestions:i,query:r});case 9:case"end":return e.stop()}},e,t)})),function(e){return r.apply(this,arguments)}),50),updateQueryMatchHighlighting:c}}var U=t(12),A=t.n(U),F="up",D="down",Q=function(e,r){return"38"===(e=""+e)?F:"40"===e?D:"9"===e?r?F:D:null};function B(e){var r=e.searchBar,t=e.isOpen,n=e.onChange,a=e.onNavigateOut,c=function(e){return function(t){var c=r.querySelectorAll("."+C),u=[].concat(A()(c)).findIndex(function(e){return l.a.hasClass(e,_)}),s=e(u);c[u]&&l.a.removeClass(c[u],_),c[s]?(t.preventDefault(),l.a.addClass(c[s],_),n(c[s].innerText)):c.length>0&&a()}},u=c(function(e){return e-1}),s=c(function(e){return e+1});document.addEventListener("keydown",function(e){if(t()){var r=Q(e.keyCode,e.shiftKey);null!==r&&(r===D&&s(e),r===F&&u(e))}})}var J=function(e){return setTimeout(e,0)};function P(e){var r=e.searchBar,t=e.focus,n=e.blur,a=void 0,c=function(){return r.contains(document.activeElement)},u=function(){t(),clearInterval(a)},s=function(){J(function(){c()||n()})},i=function(e){if(27===+e.keyCode)return e.preventDefault(),void n();40!==+e.keyCode||t()};return r.addEventListener("focus",u,!0),r.addEventListener("keydown",i),document.addEventListener("blur",s,!0),a=setInterval(function(){c()&&(t(),clearInterval(a))},500),function(){r.removeEventListener("focus",u),r.removeEventListener("keydown",i),document.removeEventListener("blur",s)}}var K=t(35),V=t.n(K),z=".js-search-bar-view-when-no-suggestion-ready",G={container:".js-search-bar-recent-searches",clear:".js-search-bar-clear-recent-searches",itemContainer:".js-search-bar-recent-searches-item-container",model:".js-search-bar-recent-search-item-model",itemText:".js-search-bar-recent-search-text"},R=".js-search-bar-collection-section",W=".js-search-bar-collections",X=".js-search-bar-collections-model",Y={title:".js-search-bar-collection-title",subtitle:".js-search-bar-collection-subtitle",imageContainer:".js-search-bar-collection-images"},Z=".js-search-bar-trending-searches",$=".js-search-bar-trending-searches-section",ee=".js-search-bar-trending-searches-model",re={image:".js-search-bar-trending-search-model-img",text:".js-search-bar-trending-search-model-text"},te="js-search-bar-dropdown-focusable-element";var ne=function(e){var r=function(e){var r=e.querySelector(G.model);return r.remove(),r.style.display=null,r}(e);return function(t){var n=r.cloneNode(!0);return n.href=T({form:e,fullText:t}),n.querySelector(G.itemText).innerText=t,n.addEventListener("click",function(){M("search-history",t)}),n}};function ae(e){var r=e.querySelector(G.container),t=e.querySelector(G.clear),n=e.querySelector(G.itemContainer),a=ne(e);t.addEventListener("click",function(){v.a()});var c=function(){var e=v.b();if(e.length<=0)return function(e){for(;e;){if(l.a.hasClass(e,te))return e.focus(),void(e=null);e=e.parentElement}}(r),void(r.style.display="none");var t=document.createDocumentFragment();e.map(a).forEach(function(e){return t.appendChild(e)}),n.innerHTML="",n.appendChild(t),r.style.display=null};c(),v.c(c)}var ce=function(e){var r=function(e){var r=e.querySelector(X);return r.remove(),r.style.display=null,r}(e);return function(e){var t=e.title,n=e.subtitle,a=e.href,c=e.images,u=void 0===c?[]:c,s=r.cloneNode(!0);return s.href=a,s.querySelector(Y.title).innerText=t,s.querySelector(Y.subtitle).innerText=n,s.querySelector(Y.imageContainer).innerHTML=u.map(function(e){return'<img src="'+e.src+'" srcset="'+e.srcset+'" />'}).join("\n"),s.addEventListener("click",function(){M("trending-collections",a)}),s}},ue=function(){var e=o()(s.a.mark(function e(r){var t,n,a,c,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.querySelector(R),n=r.querySelector(W),a=ce(r),e.next=5,b();case 5:if(!((c=e.sent).length<=0)){e.next=8;break}return e.abrupt("return");case 8:return u=document.createDocumentFragment(),c.forEach(function(e){var r=a(e);u.appendChild(r)}),n.innerHTML="",n.appendChild(u),t.style.display=null,e.abrupt("return");case 14:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),se=function(e){var r=function(e){var r=e.querySelector(ee);return r.remove(),r.style.display=null,r}(e);return function(t){var n=t.image,a=n.src,c=n.srcset,u=t.term,s=r.cloneNode(!0),i=s.querySelector(re.image);return s.href=T({fullText:u,form:e}),s.querySelector(re.text).innerText=u,s.addEventListener("click",function(){M("trending-searches",u)}),i.srcset=c||"",i.src=a,s}},ie=function(){var e=o()(s.a.mark(function e(r){var t,n,a,c,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.querySelector($),n=r.querySelector(Z),a=se(r),e.next=5,g();case 5:if(!((c=e.sent).length<=0)){e.next=8;break}return e.abrupt("return");case 8:return u=document.createDocumentFragment(),c.forEach(function(e){var r=a(e);u.appendChild(r)}),n.innerHTML="",n.appendChild(u),t.style.display=null,e.abrupt("return");case 14:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),oe=function(){var e=o()(s.a.mark(function e(r){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.all([ae(r),ue(r),ie(r)]);case 2:(t=r.querySelector(z))&&l.a.removeClass(t,z.replace(".",""));case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),le=this,fe=null,pe=function(){var e=o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!fe){e.next=2;break}return e.abrupt("return",fe);case 2:return e.next=4,l.a.get(h);case 4:return e.abrupt("return",fe=e.sent);case 5:case"end":return e.stop()}},e,le)}));return function(){return e.apply(this,arguments)}}(),he=function(){var e=o()(s.a.mark(function e(r){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return r.querySelector(f.b).innerHTML=t,e.abrupt("return",!0);case 7:case"end":return e.stop()}},e,le)}));return function(r){return e.apply(this,arguments)}}(),de=function(){var e=o()(s.a.mark(function e(r){var t,n,a,c,u,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(r);case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t=N(r),n=t.queryForNewSuggestions,a=t.updateQueryMatchHighlighting,c=r.querySelector("input"),u=!1,i=c.value,oe(r),P({searchBar:r,focus:function(){l.a.addClass(r,"search-bar--open"),r.dataset.focused=!0,u=!0},blur:function(){l.a.removeClass(r,"search-bar--open"),r.dataset.focused=!1,u=!1}}),B({searchBar:r,isOpen:function(){return u},onNavigateOut:function(){c.value=i,c.focus(),c.select(),a(c.value)},onChange:function(e){c.value=e}}),n(i),c.addEventListener("input",function(e){var r=e.target.value;n(i=r)});case 14:case"end":return e.stop()}},e,le)}));return function(r){return e.apply(this,arguments)}}();document.querySelectorAll(f.a).forEach(function(e){var r=!1,t=e.querySelector("input"),n=function n(){r||(r=!0,de(e),e.removeEventListener("click",n),e.removeEventListener("mouseenter",n),t.removeEventListener("input",n))};e.addEventListener("click",n),e.addEventListener("mouseenter",n),t.addEventListener("input",n)})}});